2025-10-03 14:38:42,078 - DEBUG - [server.py:157] - Initializing server 'adk-tool-exposing-mcp-server'
2025-10-03 14:38:42,079 - DEBUG - [server.py:414] - Registering handler for ListToolsRequest
2025-10-03 14:38:42,079 - DEBUG - [server.py:486] - Registering handler for CallToolRequest
2025-10-03 14:38:42,079 - DEBUG - [selector_events.py:64] - Using selector: KqueueSelector
2025-10-03 14:38:42,082 - DEBUG - [server.py:627] - Received message: root=InitializedNotification(method='notifications/initialized', params=None, jsonrpc='2.0')
2025-10-03 14:38:42,083 - DEBUG - [server.py:627] - Received message: <mcp.shared.session.RequestResponder object at 0x15058bb10>
2025-10-03 14:38:42,083 - INFO - [server.py:664] - Processing request of type ListToolsRequest
2025-10-03 14:38:42,083 - DEBUG - [server.py:666] - Dispatching request of type ListToolsRequest
2025-10-03 14:38:42,083 - DEBUG - [server.py:713] - Response sent
2025-10-03 14:38:45,430 - DEBUG - [server.py:627] - Received message: <mcp.shared.session.RequestResponder object at 0x15058bd90>
2025-10-03 14:38:45,431 - INFO - [server.py:664] - Processing request of type CallToolRequest
2025-10-03 14:38:45,431 - DEBUG - [server.py:666] - Dispatching request of type CallToolRequest
2025-10-03 14:38:52,948 - WARNING - [client.py:78] - [WARN] pyarrow is not installed by default since databricks-sql-connector 4.0.0,any arrow specific api (e.g. fetchmany_arrow) and cloud fetch will be disabled.If you need these features, please run pip install pyarrow or pip install databricks-sql-connector[pyarrow] to install
2025-10-03 14:38:52,948 - DEBUG - [client.py:241] - Connection.__init__(server_hostname=https://dbc-e7442730-51a3.cloud.databricks.com, http_path=/sql/1.0/warehouses/7c8f2485e0555874)
2025-10-03 14:38:52,958 - DEBUG - [unified_http_client.py:153] - No system proxy detected, using direct connections only
2025-10-03 14:38:52,958 - DEBUG - [session.py:115] - Creating Thrift backend client
2025-10-03 14:38:52,958 - DEBUG - [thrift_backend.py:149] - ThriftBackend.__init__(server_hostname=https://dbc-e7442730-51a3.cloud.databricks.com, port=443, http_path=/sql/1.0/warehouses/7c8f2485e0555874)
2025-10-03 14:38:52,958 - DEBUG - [thrift_backend.py:259] - retry parameter: _retry_delay_min given_or_default 1.0
2025-10-03 14:38:52,958 - DEBUG - [thrift_backend.py:259] - retry parameter: _retry_delay_max given_or_default 60.0
2025-10-03 14:38:52,958 - DEBUG - [thrift_backend.py:259] - retry parameter: _retry_stop_after_attempts_count given_or_default 30
2025-10-03 14:38:52,958 - DEBUG - [thrift_backend.py:259] - retry parameter: _retry_stop_after_attempts_duration given_or_default 900.0
2025-10-03 14:38:52,958 - DEBUG - [thrift_backend.py:259] - retry parameter: _retry_delay_default given_or_default 5.0
2025-10-03 14:38:52,963 - DEBUG - [thrift_backend.py:408] - Sending request: OpenSession(<REDACTED>)
2025-10-03 14:38:52,963 - DEBUG - [connectionpool.py:1049] - Starting new HTTPS connection (1): dbc-e7442730-51a3.cloud.databricks.com:443
2025-10-03 14:38:54,607 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 132
2025-10-03 14:38:54,607 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:38:54,607 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:38:54,608 - DEBUG - [thrift_backend.py:420] - Received response: TOpenSessionResp(<REDACTED>)
2025-10-03 14:38:54,609 - INFO - [session.py:140] - Successfully opened session 01f0a038-95fd-17d1-9e8d-cde87330fac3
2025-10-03 14:38:54,609 - DEBUG - [telemetry_client.py:437] - Global exception handler installed for telemetry
2025-10-03 14:38:54,609 - DEBUG - [telemetry_client.py:399] - TelemetryClientFactory initialized with thread pool (max_workers=10)
2025-10-03 14:38:54,610 - DEBUG - [telemetry_client.py:468] - Creating new TelemetryClient for connection 01f0a038-95fd-17d1-9e8d-cde87330fac3
2025-10-03 14:38:54,610 - INFO - [databricks_mcp_server.py:78] - Executing query: SELECT product, SUM(quantity) AS total_quantity FROM workspace.bakehouse.sales_transactions GROUP BY product ORDER BY total_quantity DESC LIMIT 5
2025-10-03 14:38:54,610 - DEBUG - [client.py:929] - Cursor.execute(operation=SELECT product, SUM(quantity) AS total_quantity FROM workspace.bakehouse.sales_transactions GROUP BY product ORDER BY total_quantity DESC LIMIT 5, parameters=None)
2025-10-03 14:38:54,610 - DEBUG - [thrift_backend.py:1015] - ThriftBackend.execute_command(operation=SELECT product, SUM(quantity) AS total_quantity FROM workspace.bakehouse.sales_transactions GROUP BY product ORDER BY total_quantity DESC LIMIT 5, session_handle=TSessionHandle(sessionId=THandleIdentifier(guid=b'\x01\xf0\xa08\x95\xfd\x17\xd1\x9e\x8d\xcd\xe8s0\xfa\xc3', secret=b'3\x8dR\x9d\x82rF\xeb\x84\x82\xcbA\x94f\x83\x9d'), serverProtocolVersion=42247))
2025-10-03 14:38:54,610 - DEBUG - [thrift_backend.py:408] - Sending request: ExecuteStatement(<REDACTED>)
2025-10-03 14:38:55,017 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 135
2025-10-03 14:38:55,017 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:38:55,017 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:38:55,019 - DEBUG - [thrift_backend.py:420] - Received response: TExecuteStatementResp(<REDACTED>)
2025-10-03 14:38:55,019 - DEBUG - [thrift_backend.py:408] - Sending request: GetOperationStatus(<REDACTED>)
2025-10-03 14:39:05,421 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 53
2025-10-03 14:39:05,421 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:05,421 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:05,422 - DEBUG - [thrift_backend.py:420] - Received response: TGetOperationStatusResp(<REDACTED>)
2025-10-03 14:39:05,422 - DEBUG - [thrift_backend.py:408] - Sending request: GetOperationStatus(<REDACTED>)
2025-10-03 14:39:07,267 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 53
2025-10-03 14:39:07,268 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:07,268 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:07,269 - DEBUG - [thrift_backend.py:420] - Received response: TGetOperationStatusResp(<REDACTED>)
2025-10-03 14:39:07,269 - DEBUG - [thrift_backend.py:408] - Sending request: GetOperationStatus(<REDACTED>)
2025-10-03 14:39:12,879 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 75
2025-10-03 14:39:12,880 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:12,880 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:12,881 - DEBUG - [thrift_backend.py:420] - Received response: TGetOperationStatusResp(<REDACTED>)
2025-10-03 14:39:12,881 - DEBUG - [thrift_backend.py:408] - Sending request: GetOperationStatus(<REDACTED>)
2025-10-03 14:39:16,423 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 75
2025-10-03 14:39:16,424 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:16,424 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:16,425 - DEBUG - [thrift_backend.py:420] - Received response: TGetOperationStatusResp(<REDACTED>)
2025-10-03 14:39:16,425 - DEBUG - [thrift_backend.py:408] - Sending request: GetResultSetMetadata(<REDACTED>)
2025-10-03 14:39:16,845 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 217
2025-10-03 14:39:16,846 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:16,846 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:16,848 - DEBUG - [thrift_backend.py:420] - Received response: TGetResultSetMetadataResp(<REDACTED>)
2025-10-03 14:39:16,848 - DEBUG - [thrift_backend.py:408] - Sending request: FetchResults(<REDACTED>)
2025-10-03 14:39:17,337 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 440
2025-10-03 14:39:17,337 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:17,338 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:17,341 - DEBUG - [thrift_backend.py:420] - Received response: TFetchResultsResp(<REDACTED>)
2025-10-03 14:39:17,342 - INFO - [databricks_mcp_server.py:89] - output_data : [{'product': 'Golden Gate Ginger', 'total_quantity': 3865}, {'product': 'Outback Oatmeal', 'total_quantity': 3733}, {'product': 'Austin Almond Biscotti', 'total_quantity': 3716}, {'product': 'Tokyo Tidbits', 'total_quantity': 3662}, {'product': 'Pearly Pies', 'total_quantity': 3595}]
2025-10-03 14:39:17,342 - DEBUG - [thrift_backend.py:1353] - ThriftBackend.close_command(command_id=01f0a038-9647-144c-9c35-12d93786478c|338d529d-8272-46eb-8482-cb419466839d)
2025-10-03 14:39:17,343 - DEBUG - [thrift_backend.py:408] - Sending request: CloseOperation(<REDACTED>)
2025-10-03 14:39:17,748 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 42
2025-10-03 14:39:17,748 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:17,749 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:17,749 - DEBUG - [thrift_backend.py:420] - Received response: TCloseOperationResp(<REDACTED>)
2025-10-03 14:39:17,750 - INFO - [session.py:173] - Closing session 01f0a038-95fd-17d1-9e8d-cde87330fac3
2025-10-03 14:39:17,750 - DEBUG - [thrift_backend.py:408] - Sending request: CloseSession(<REDACTED>)
2025-10-03 14:39:18,074 - DEBUG - [connectionpool.py:544] - https://dbc-e7442730-51a3.cloud.databricks.com:443 "POST /sql/1.0/warehouses/7c8f2485e0555874 HTTP/1.1" 200 40
2025-10-03 14:39:18,075 - INFO - [retry.py:355] - Received status code 200 for POST request
2025-10-03 14:39:18,075 - INFO - [thrift_http_client.py:208] - HTTP Response with status code 200, message: OK
2025-10-03 14:39:18,076 - DEBUG - [thrift_backend.py:420] - Received response: TCloseSessionResp(<REDACTED>)
2025-10-03 14:39:18,076 - DEBUG - [telemetry_client.py:510] - Removing telemetry client for connection 01f0a038-95fd-17d1-9e8d-cde87330fac3
2025-10-03 14:39:18,076 - DEBUG - [telemetry_client.py:517] - No more telemetry clients, shutting down thread pool executor
2025-10-03 14:39:18,079 - DEBUG - [server.py:713] - Response sent
2025-10-03 14:39:18,087 - DEBUG - [server.py:627] - Received message: <mcp.shared.session.RequestResponder object at 0x15050e520>
2025-10-03 14:39:18,087 - INFO - [server.py:664] - Processing request of type ListToolsRequest
2025-10-03 14:39:18,087 - DEBUG - [server.py:666] - Dispatching request of type ListToolsRequest
2025-10-03 14:39:18,088 - DEBUG - [server.py:713] - Response sent
2025-10-03 15:30:51,895 - DEBUG - [telemetry_client.py:442] - Handling unhandled exception: ValueError
